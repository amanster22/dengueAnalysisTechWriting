---
title: "dengueAnalysis"
author: "Aman Shaik, Nick Huberty, Tom Suo, Connor Lee"
date: "2025-10-07"
output: html_document
---

### Our group was initially interested in exploring Public Health-related datasets due to our desire of exploring geospatial details of disease and how that affects different geographies. COVID-19 was a huge influence to us wanting to experiment with another form of health concern. This specific dataset includes cases of the Dengue Fever in the city of Merida, from 2012 to 2015, and outlines the coordinates of where every case specifically took place. Through our analysis, we plan on visualizing how the Dengue Fever has spread across Merida over a four-year period, and how it can help inform how diseases typically spread in urban environments.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r data_loading}
library(ggplot2)
data <- read.csv('Merida_Den12_13_14_15.csv')
head(data)
```

```{r summary}
summary(data)
```

```{r mapping_plot} 
#maybe overlay the map of the location
# This plot shows the geospatial location of dengue incidence in Merida, Mexico. We can potentially aesthetically improve this plot later using QGIS or ArcGIS.
plot(data$X, data$Y, 
     main = "Spatial Locations of Sampling Points",
     xlab = "X Coordinate", 
     ylab = "Y Coordinate", 
     pch = 19, col = "blue")
library(ggplot2)
# 1️ Read file
library(sf)

town_map <- st_read("C:/Users/pompo/OneDrive/Documents/GitHub/dengueAnalysisTechWriting/Merida_S25/Merida_Den12_13_14_15")
st_crs(town_map)
disease_data <- read.csv('Merida_Den12_13_14_15.csv')

# make sure CRS is same, convert to sf
disease_sf <- st_as_sf(disease_data, coords = c("X", "Y"), crs = st_crs(town_map))
names(disease_data)

# 4 generate plot
ggplot() +
  geom_sf(data = town_map, fill = "gray95", color = "black", linewidth = 0.3) +
  geom_sf(data = disease_sf, aes(color = Den2012, size = Den2012)) +
  scale_color_viridis_c(option = "plasma") +
  theme_minimal() +
  labs(title = "Spatial Locations",
       color = "Incidence",
       size = "Incidence")

```

```{r mapping_ggplot}
# This plot shows the density of dengue, indicating more vulnerable areas in the city. 

ggplot(data, aes(x = X, y = Y, color = Den2012)) +
  geom_point(size = 3) +
  scale_color_viridis_c(option = "plasma") +
  labs(title = "Dengue Fever Density (2012)",
       x = "X Coordinate", y = "Y Coordinate",
       color = "Density") +
  theme_minimal()

```


This interactive plot visualizes the density and geographic spread of Dengue Fever cases in Merida, Mexico, from 2012 to 2015. The animation reveals a dynamic pattern: the outbreaks in 2012 and 2013 were diversely concentrated across the city. From 2014 onwards, there were far fewer hotspots. However, while the 2015 outbreak appears less widespread, the data indicates a significant spike in total cases from the previous year, suggesting that the remaining hotspots became much more intense.
```{r mapping_ggplot}
library(plotly)
library(tidyr)
library(dplyr)

data <- read.csv('Merida_Den12_13_14_15.csv')

data_long <- data %>%
  pivot_longer(
    cols = starts_with("Den"),
    names_to = "Year",
    names_prefix = "Den",
    values_to = "Cases"
  ) %>%
  mutate(Year = as.integer(Year))

fig <- plot_ly(
  data_long,
  x = ~X,
  y = ~Y,
  frame = ~Year,
  type = 'scatter',
  mode = 'markers',
  marker = list(
    size = 10,
    color = ~Cases,  # color corresponds directly to number of cases
    colorscale = list(
      list(0, "lightgrey"),
      list(1, "red")
    ),
    showscale = TRUE,
    colorbar = list(title = "Case Count"),
    line = list(width = 0)  # removes border around points for cleaner look
  ),
  # Include coordinates + year + case count in hover
  text = ~paste(
    "Year:", Year,
    "<br>Cases:", Cases,
    "<br>X:", round(X, 2),
    "<br>Y:", round(Y, 2)
  ),
  hoverinfo = 'text'
)

fig <- fig %>%
  layout(
    title = 'Dengue Fever Density in Merida (2012–2015)',
    xaxis = list(title = 'X Coordinate'),
    yaxis = list(title = 'Y Coordinate'),
    plot_bgcolor = "#f0f0f0",
    paper_bgcolor = "#f0f0f0"
  ) %>%
  animation_opts(
    frame = 1500,
    transition = 500,
    easing = "linear"
  ) %>%
  animation_slider(
    currentvalue = list(
      prefix = "Year: ",
      font = list(color = "red")
    )
  )

fig

```
